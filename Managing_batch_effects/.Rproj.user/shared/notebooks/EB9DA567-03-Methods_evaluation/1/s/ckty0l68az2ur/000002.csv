"0","# AD data"
"0","ad.data.design <- numeric()"
"0","ad.data.design$group <- ad.trt"
"2","Coercing LHS to a list"
"0","ad.data.design$batch <- ad.batch"
"0","# before"
"0","# conditioning on a batch effect"
"0","ad.rda.before1 <- rda(ad.clr ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.before2 <- rda(ad.clr ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.before <- ad.rda.before1$pCCA$tot.chi*100/ad.rda.before1$tot.chi"
"0","ad.rda.trt_prop.before <- ad.rda.before2$pCCA$tot.chi*100/ad.rda.before2$tot.chi"
"0","# BMC"
"0","# conditioning on a batch effect"
"0","ad.rda.bmc1 <- rda(ad.bmc ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.bmc2 <- rda(ad.bmc ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.bmc <- ad.rda.bmc1$pCCA$tot.chi*100/ad.rda.bmc1$tot.chi"
"0","ad.rda.trt_prop.bmc <- ad.rda.bmc2$pCCA$tot.chi*100/ad.rda.bmc2$tot.chi"
"0","# combat"
"0","# conditioning on a batch effect"
"0","ad.rda.combat1 <- rda(ad.combat ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.combat2 <- rda(ad.combat ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.combat <- ad.rda.combat1$pCCA$tot.chi*100/ad.rda.combat1$tot.chi"
"0","ad.rda.trt_prop.combat <- ad.rda.combat2$pCCA$tot.chi*100/ad.rda.combat2$tot.chi"
"0","# limma"
"0","# conditioning on a batch effect"
"0","ad.rda.limma1 <- rda(ad.limma ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.limma2 <- rda(ad.limma ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.limma <- ad.rda.limma1$pCCA$tot.chi*100/ad.rda.limma1$tot.chi"
"0","ad.rda.trt_prop.limma <- ad.rda.limma2$pCCA$tot.chi*100/ad.rda.limma2$tot.chi"
"0","# percentile"
"0","# conditioning on a batch effect"
"0","ad.rda.percentile1 <- rda(ad.percentile ~ group + Condition(batch), "
"0","                         data = ad.data.design)"
"0","ad.rda.percentile2 <- rda(ad.percentile ~ batch + Condition(group), "
"0","                         data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.percentile <- ad.rda.percentile1$pCCA$tot.chi*100/ad.rda.percentile1$tot.chi"
"0","ad.rda.trt_prop.percentile <- ad.rda.percentile2$pCCA$tot.chi*100/ad.rda.percentile2$tot.chi"
"0","# SVD"
"0","# conditioning on a batch effect"
"0","ad.rda.svd1 <- rda(ad.svd ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.svd2 <- rda(ad.svd ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.svd <- ad.rda.svd1$pCCA$tot.chi*100/ad.rda.svd1$tot.chi"
"0","ad.rda.trt_prop.svd <- ad.rda.svd2$pCCA$tot.chi*100/ad.rda.svd2$tot.chi"
"0","# RUVIII"
"0","# conditioning on a batch effect"
"0","ad.rda.ruv1 <- rda(ad.ruvIII ~ group + Condition(batch), data = ad.data.design)"
"0","ad.rda.ruv2 <- rda(ad.ruvIII ~ batch + Condition(group), data = ad.data.design)"
"0","# amount of variance"
"0","ad.rda.bat_prop.ruv <- ad.rda.ruv1$pCCA$tot.chi*100/ad.rda.ruv1$tot.chi"
"0","ad.rda.trt_prop.ruv <- ad.rda.ruv2$pCCA$tot.chi*100/ad.rda.ruv2$tot.chi"
