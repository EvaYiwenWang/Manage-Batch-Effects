"0","# AD data"
"0","ad.silh.before <- calc.sil(ad.pca.before$variates$X, y1 = ad.batch, "
"0","                          y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.bmc <- calc.sil(ad.pca.bmc$variates$X, y1 = ad.batch, "
"0","                       y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.combat <- calc.sil(ad.pca.combat$variates$X, y1 = ad.batch, "
"0","                          y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.limma <- calc.sil(ad.pca.limma$variates$X, y1 = ad.batch, "
"0","                         y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.percentile <- calc.sil(ad.pca.percentile$variates$X, y1 = ad.batch, "
"0","                              y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.svd <- calc.sil(ad.pca.svd$variates$X, y1 = ad.batch, "
"0","                       y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.ruv <- calc.sil(ad.pca.ruv$variates$X, y1 = ad.batch, "
"0","                       y2 = ad.trt, name.y1 = 'Batch', name.y2 = 'Treatment')"
"0","ad.silh.plot <- rbind(ad.silh.before, ad.silh.bmc, ad.silh.combat, "
"0","                     ad.silh.limma, ad.silh.percentile, ad.silh.svd, ad.silh.ruv)"
"0","ad.silh.plot$method <- c(rep('Before', nrow(ad.silh.before)), "
"0","                        rep('BMC', nrow(ad.silh.bmc)),"
"0","                        rep('ComBat', nrow(ad.silh.combat)),"
"0","                        rep('rBE', nrow(ad.silh.limma)),"
"0","                        rep('PN', nrow(ad.silh.percentile)),"
"0","                        rep('SVD', nrow(ad.silh.svd)),"
"0","                        rep('RUVIII', nrow(ad.silh.ruv))"
"0",")"
"0","ad.silh.plot$method <- factor(ad.silh.plot$method, levels = unique(ad.silh.plot$method))"
"0","ad.silh.plot$Cluster <- factor(ad.silh.plot$Cluster, levels = unique(ad.silh.plot$Cluster))"
"0","ad.silh.plot$Type <- factor(ad.silh.plot$Type, levels = unique(ad.silh.plot$Type))"
"0","ggplot(ad.silh.plot, aes(x = Type, y = silh.coeff, color = Cluster, shape = Type)) + "
"0","  geom_point() + facet_grid(cols = vars(method)) + theme_bw() + "
"0","  theme(axis.text.x = element_text(angle = 60, hjust = 1), "
"0","        strip.text = element_text(size = 12), panel.grid = element_blank(), "
"0","        axis.text = element_text(size = 10), axis.title = element_text(size = 15),"
"0","        legend.title = element_text(size = 15), legend.text = element_text(size = 12)) + "
"0","  scale_color_manual(values = c('#388ECC', '#F68B33', '#C2C2C2', '#009E73', "
"0","                                '#CC79A7', '#0072B2', '#999999')) + "
"0","  labs(x = 'Type', y = 'Silhouette Coefficient', name = 'Type') "
