"0","# Sponge data"
"0","sponge.silh.before <- calc.sil(sponge.pca.before$variates$X, "
"0","                              y1 = sponge.batch, y2 = sponge.trt, "
"0","                              name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.bmc <- calc.sil(sponge.pca.bmc$variates$X, "
"0","                           y1 = sponge.batch, y2 = sponge.trt, "
"0","                           name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.combat <- calc.sil(sponge.pca.combat$variates$X, "
"0","                              y1 = sponge.batch, y2 = sponge.trt, "
"0","                              name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.limma <- calc.sil(sponge.pca.limma$variates$X, "
"0","                             y1 = sponge.batch, y2 = sponge.trt, "
"0","                             name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.percentile <- calc.sil(sponge.pca.percentile$variates$X, "
"0","                                  y1 = sponge.batch, y2 = sponge.trt, "
"0","                                  name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.svd <- calc.sil(sponge.pca.svd$variates$X, "
"0","                           y1 = sponge.batch, y2 = sponge.trt, "
"0","                           name.y1 = 'Batch', name.y2 = 'Tissue')"
"0","sponge.silh.plot <- rbind(sponge.silh.before, sponge.silh.bmc, sponge.silh.combat, "
"0","                         sponge.silh.limma, sponge.silh.percentile, sponge.silh.svd)"
"0","sponge.silh.plot$method <- c(rep('Before', nrow(sponge.silh.before)), "
"0","                            rep('BMC', nrow(sponge.silh.bmc)),"
"0","                            rep('ComBat', nrow(sponge.silh.combat)),"
"0","                            rep('rBE', nrow(sponge.silh.limma)),"
"0","                            rep('PN', nrow(sponge.silh.percentile)),"
"0","                            rep('SVD', nrow(sponge.silh.svd))"
"0",")"
"0","sponge.silh.plot$method <- factor(sponge.silh.plot$method, "
"0","                                 levels = unique(sponge.silh.plot$method))"
"0","sponge.silh.plot$Cluster <- factor(sponge.silh.plot$Cluster, "
"0","                                   levels = unique(sponge.silh.plot$Cluster))"
"0","sponge.silh.plot$Type <- factor(sponge.silh.plot$Type, "
"0","                                levels = unique(sponge.silh.plot$Type))"
"0","ggplot(sponge.silh.plot, aes(x = Type, y = silh.coeff, color = Cluster, shape = Type)) + "
"0","  geom_point() + facet_grid(cols = vars(method)) + theme_bw() + "
"0","  theme(axis.text.x = element_text(angle = 60, hjust = 1), "
"0","        strip.text = element_text(size = 12), panel.grid = element_blank(), "
"0","        axis.text = element_text(size = 12), axis.title = element_text(size = 15),"
"0","        legend.title = element_text(size = 15), legend.text = element_text(size = 12)) + "
"0","  scale_color_manual(values = c('#388ECC','#F68B33','#F0E442','#D55E00')) + "
"0","  labs(x = 'Type', y = 'Silhouette Coefficient', name = 'Type') "
