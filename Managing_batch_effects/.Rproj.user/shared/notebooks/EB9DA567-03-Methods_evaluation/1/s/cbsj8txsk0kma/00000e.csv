"0","# proportion"
"0","sponge.rda.prop.before <- c(sponge.rda.bat_prop.before, "
"0","                           sponge.rda.trt_prop.before)"
"0","sponge.rda.prop.bmc <- c(sponge.rda.bat_prop.bmc, "
"0","                        sponge.rda.trt_prop.bmc)"
"0","sponge.rda.prop.combat <- c(sponge.rda.bat_prop.combat, "
"0","                           sponge.rda.trt_prop.combat)"
"0","sponge.rda.prop.limma <- c(sponge.rda.bat_prop.limma, "
"0","                          sponge.rda.trt_prop.limma)"
"0","sponge.rda.prop.percentile <- c(sponge.rda.bat_prop.percentile, "
"0","                               sponge.rda.trt_prop.percentile)"
"0","sponge.rda.prop.svd <- c(sponge.rda.bat_prop.svd, "
"0","                        sponge.rda.trt_prop.svd)"
"0","# merge results"
"0","sponge.rda.prop.val <- c(sponge.rda.prop.before, sponge.rda.prop.bmc, "
"0","                        sponge.rda.prop.combat, sponge.rda.prop.limma, "
"0","                        sponge.rda.prop.percentile, sponge.rda.prop.svd)"
"0","# add batch, trt and method info"
"0","sponge.rda.prop <- data.frame(prop = sponge.rda.prop.val, "
"0","                             prop.r = round(sponge.rda.prop.val, 2), "
"0","                             Method = rep(c('Before', 'BMC', 'ComBat', "
"0","                                            'rBE', 'PN', 'SVD'), each = 2), "
"0","                             Type = rep(c('Batch', 'Tissue'), 6))"
"0","# reorder levels"
"0","sponge.rda.prop$Method <- factor(sponge.rda.prop$Method, "
"0","                                levels = unique(sponge.rda.prop$Method))"
"0","ggplot(data = sponge.rda.prop, aes(x = Method, y = prop, fill = Type)) + "
"0","  geom_bar(stat = ""identity"", position = 'dodge', colour = 'black') + "
"0","  geom_text(data = sponge.rda.prop, aes(Method, prop + 2.5, label = prop.r), "
"0","            position = position_dodge(width = 0.9), size = 3) + theme_bw() + "
"0","  labs(y = ""Variance explained (%)"") + "
"0","  theme(axis.text.x = element_text(angle = 60, hjust = 1), "
"0","        panel.grid = element_blank(), axis.text = element_text(size = 12), "
"0","        axis.title = element_text(size = 15), legend.title = element_text(size = 15),"
"0","        legend.text = element_text(size = 12)) + ylim(0,100)"
