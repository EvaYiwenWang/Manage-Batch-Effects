"0","# ad data"
"0","ad.sd <- apply(ad.tss.clr, 2, sd)"
"0","ad.mean <- apply(ad.tss.clr, 2, mean)"
"0","ad.X <- scale(ad.tss.clr,center = T, scale = T)"
"0","ad.m <- crossprod(ad.X)"
"0","ad.m.svd <- svd(ad.m)"
"0","#barplot(ad.m.svd$d)"
"0","ad.a1 <- ad.m.svd$u[ ,1]"
"0","ad.b1 <- ad.m.svd$v[ ,1]"
"0","# component 1"
"0","ad.t1 <- ad.X %*% ad.a1 / drop(sqrt(crossprod(ad.a1)))"
"0","ad.c1 <- crossprod(ad.X, ad.t1) / drop(crossprod(ad.t1))"
"0","ad.svd.defl.matrix1  <- ad.X - ad.t1 %*% t(ad.c1)"
"0","ad.svd <- ad.svd.defl.matrix1"
"0","ad.svd[1:nrow(ad.svd), 1:ncol(ad.svd)] = NA"
"0","for(i in 1:ncol(ad.svd.defl.matrix1)){"
"0","  for(j in 1:nrow(ad.svd.defl.matrix1)){"
"0","    ad.svd[j,i] = ad.svd.defl.matrix1[j,i]*ad.sd[i] + ad.mean[i]"
"0","  }"
"0","}"
