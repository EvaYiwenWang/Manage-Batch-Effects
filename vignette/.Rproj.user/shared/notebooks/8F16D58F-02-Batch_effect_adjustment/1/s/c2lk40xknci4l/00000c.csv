"0","a1.sponge = m.svd.sponge$u[,1]"
"0","b1.sponge = m.svd.sponge$v[,1]"
"0","# component 1"
"0","t1.sponge = X.sponge %*% a1.sponge / drop(sqrt(crossprod(a1.sponge)))"
"0","c1.sponge = crossprod(X.sponge, t1.sponge) / drop(crossprod(t1.sponge))"
"0","defl.matrix_svd1.sponge  = X.sponge - t1.sponge %*% t(c1.sponge)"
"0","# #"
"0","sponge.svd = defl.matrix_svd1.sponge"
"0","sponge.svd[1:nrow(sponge.svd),1:ncol(sponge.svd)] = NA"
"0","for(i in 1:ncol(defl.matrix_svd1.sponge)){"
"0","  for(j in 1:nrow(defl.matrix_svd1.sponge)){"
"0","    sponge.svd[j,i] = defl.matrix_svd1.sponge[j,i]*sponge.sd[i] + sponge.mean[i]"
"0","  }"
"0","}"
"0","#####################"
"0","# ad data"
"0","ad.sd = apply(ad.tss.clr,2,sd)"
"0","ad.mean = apply(ad.tss.clr,2,mean)"
"0","X.ad = scale(ad.tss.clr,center = T,scale = T)"
"0","m.ad = crossprod(X.ad)"
"0","m.svd.ad = svd(m.ad)"
"0","barplot(m.svd.ad$d)"
