"0","# merge results"
"0","ad.pvca.prop.val <- c(ad.PVCA.score$Batch, ad.PVCA.score$Treatment)"
"0","# add batch, trt and method info"
"0","ad.pvca.prop <- data.frame(prop = ad.pvca.prop.val, prop.r = round(ad.pvca.prop.val, 2), "
"0","                          Method = rep(c('Before', 'BMC', 'ComBat', 'rBE', "
"0","                                         'PN', 'SVD', 'RUVIII'), 2), "
"0","                          Type = rep(c('Batch', 'Treatment'), each = 7))"
"0","# reorder levels"
"0","ad.pvca.prop$Method <- factor(ad.pvca.prop$Method, levels = unique(ad.pvca.prop$Method))"
"0","ggplot(data = ad.pvca.prop, aes(x = Method, y = prop, fill = Type)) + "
"0","  geom_bar(stat = ""identity"", position = 'dodge', colour = 'black') + "
"0","  geom_text(data = ad.pvca.prop, aes(Method, prop + 0.03, label = prop.r), "
"0","            position = position_dodge(width = 0.9), size = 3) + theme_bw() + "
"0","  labs(y = ""Weighted average proportion variance"") + "
"0","  theme(axis.text.x = element_text(angle = 60, hjust = 1), "
"0","        panel.grid = element_blank(),axis.text = element_text(size = 12), "
"0","        axis.title = element_text(size = 15), legend.title = element_text(size = 15), "
"0","        legend.text = element_text(size = 12)) + scale_fill_hue(l = 40) + ylim(0,1)"
