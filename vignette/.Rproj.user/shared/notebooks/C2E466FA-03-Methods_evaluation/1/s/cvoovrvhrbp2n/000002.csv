"0","# Sponge data"
"0","sponge.data.design <- numeric()"
"0","sponge.data.design$group <- sponge.trt"
"2","Coercing LHS to a list"
"0","sponge.data.design$batch <- sponge.batch"
"0","# before"
"0","# conditioning on a batch effect"
"0","sponge.rda.before1 <- rda(sponge.tss.clr ~ group + Condition(batch), "
"0","                         data = sponge.data.design)"
"0","sponge.rda.before2 <- rda(sponge.tss.clr ~ batch + Condition(group), "
"0","                         data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.before <- sponge.rda.before1$pCCA$tot.chi*100/sponge.rda.before1$tot.chi"
"0","sponge.rda.trt_prop.before <- sponge.rda.before2$pCCA$tot.chi*100/sponge.rda.before2$tot.chi"
"0","# BMC"
"0","# conditioning on a batch effect"
"0","sponge.rda.bmc1 <- rda(sponge.bmc ~ group + Condition(batch), "
"0","                      data = sponge.data.design)"
"0","sponge.rda.bmc2 <- rda(sponge.bmc ~ batch + Condition(group), "
"0","                      data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.bmc <- sponge.rda.bmc1$pCCA$tot.chi*100/sponge.rda.bmc1$tot.chi"
"0","sponge.rda.trt_prop.bmc <- sponge.rda.bmc2$pCCA$tot.chi*100/sponge.rda.bmc2$tot.chi"
"0","# combat"
"0","# conditioning on a batch effect"
"0","sponge.rda.combat1 <- rda(sponge.combat ~ group + Condition(batch), "
"0","                         data = sponge.data.design)"
"0","sponge.rda.combat2 <- rda(sponge.combat ~ batch + Condition(group), "
"0","                         data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.combat <- sponge.rda.combat1$pCCA$tot.chi*100/sponge.rda.combat1$tot.chi"
"0","sponge.rda.trt_prop.combat <- sponge.rda.combat2$pCCA$tot.chi*100/sponge.rda.combat2$tot.chi"
"0","# limma"
"0","# conditioning on a batch effect"
"0","sponge.rda.limma1 <- rda(sponge.limma ~ group + Condition(batch), "
"0","                        data = sponge.data.design)"
"0","sponge.rda.limma2 <- rda(sponge.limma ~ batch + Condition(group), "
"0","                        data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.limma <- sponge.rda.limma1$pCCA$tot.chi*100/sponge.rda.limma1$tot.chi"
"0","sponge.rda.trt_prop.limma <- sponge.rda.limma2$pCCA$tot.chi*100/sponge.rda.limma2$tot.chi"
"0","# percentile"
"0","# conditioning on a batch effect"
"0","sponge.rda.percentile1 <- rda(sponge.percentile ~ group + Condition(batch), "
"0","                             data = sponge.data.design)"
"0","sponge.rda.percentile2 <- rda(sponge.percentile ~ batch + Condition(group), "
"0","                             data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.percentile <- sponge.rda.percentile1$pCCA$tot.chi*100/sponge.rda.percentile1$tot.chi"
"0","sponge.rda.trt_prop.percentile <- sponge.rda.percentile2$pCCA$tot.chi*100/sponge.rda.percentile2$tot.chi"
"0","# SVD"
"0","# conditioning on a batch effect"
"0","sponge.rda.svd1 <- rda(sponge.svd ~ group + Condition(batch), "
"0","                      data = sponge.data.design)"
"0","sponge.rda.svd2 <- rda(sponge.svd ~ batch + Condition(group), "
"0","                      data = sponge.data.design)"
"0","# amount of variance"
"0","sponge.rda.bat_prop.svd <- sponge.rda.svd1$pCCA$tot.chi*100/sponge.rda.svd1$tot.chi"
"0","sponge.rda.trt_prop.svd <- sponge.rda.svd2$pCCA$tot.chi*100/sponge.rda.svd2$tot.chi"
