"0","# Sponge data"
"0","data.design.sponge = numeric()"
"0","data.design.sponge$group = sponge.trt"
"2","Coercing LHS to a list"
"0","data.design.sponge$batch = sponge.batch"
"0","# before"
"0","# conditioning on a batch effect"
"0","rda.sponge.before1 = rda(sponge.tss.clr ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.before2 = rda(sponge.tss.clr ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.before = rda.sponge.before1$pCCA$tot.chi*100/rda.sponge.before1$tot.chi"
"0","rda.prop.trt.sponge.before = rda.sponge.before2$pCCA$tot.chi*100/rda.sponge.before1$tot.chi"
"0","# BMC"
"0","# conditioning on a batch effect"
"0","rda.sponge.bmc1 = rda(sponge.bmc ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.bmc2 = rda(sponge.bmc ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.bmc = rda.sponge.bmc1$pCCA$tot.chi*100/rda.sponge.bmc1$tot.chi"
"0","rda.prop.trt.sponge.bmc = rda.sponge.bmc2$pCCA$tot.chi*100/rda.sponge.bmc2$tot.chi"
"0","# combat"
"0","# conditioning on a batch effect"
"0","rda.sponge.combat1 = rda(sponge.combat ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.combat2 = rda(sponge.combat ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.combat = rda.sponge.combat1$pCCA$tot.chi*100/rda.sponge.combat1$tot.chi"
"0","rda.prop.trt.sponge.combat = rda.sponge.combat2$pCCA$tot.chi*100/rda.sponge.combat2$tot.chi"
"0","# limma"
"0","# conditioning on a batch effect"
"0","rda.sponge.limma1 = rda(sponge.limma ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.limma2 = rda(sponge.limma ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.limma = rda.sponge.limma1$pCCA$tot.chi*100/rda.sponge.limma1$tot.chi"
"0","rda.prop.trt.sponge.limma = rda.sponge.limma2$pCCA$tot.chi*100/rda.sponge.limma2$tot.chi"
"0","# percentile"
"0","# conditioning on a batch effect"
"0","rda.sponge.percentile1 = rda(sponge.percentile ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.percentile2 = rda(sponge.percentile ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.percentile = rda.sponge.percentile1$pCCA$tot.chi*100/rda.sponge.percentile1$tot.chi"
"0","rda.prop.trt.sponge.percentile = rda.sponge.percentile2$pCCA$tot.chi*100/rda.sponge.percentile2$tot.chi"
"0","# SVD"
"0","# conditioning on a batch effect"
"0","rda.sponge.svd1 = rda(sponge.svd ~ group + Condition(batch), data = data.design.sponge)"
"0","rda.sponge.svd2 = rda(sponge.svd ~ batch + Condition(group), data = data.design.sponge)"
"0","# amount of variance"
"0","rda.prop.bat.sponge.svd = rda.sponge.svd1$pCCA$tot.chi*100/rda.sponge.svd1$tot.chi"
"0","rda.prop.trt.sponge.svd = rda.sponge.svd2$pCCA$tot.chi*100/rda.sponge.svd2$tot.chi"
