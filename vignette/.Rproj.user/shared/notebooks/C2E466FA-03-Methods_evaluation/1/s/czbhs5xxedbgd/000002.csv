"0","# proportion"
"0","ad.rda.prop.before <- c(ad.rda.bat_prop.before, ad.rda.trt_prop.before)"
"0","ad.rda.prop.bmc <- c(ad.rda.bat_prop.bmc, ad.rda.trt_prop.bmc)"
"0","ad.rda.prop.combat <- c(ad.rda.bat_prop.combat, ad.rda.trt_prop.combat)"
"0","ad.rda.prop.limma <- c(ad.rda.bat_prop.limma, ad.rda.trt_prop.limma)"
"0","ad.rda.prop.percentile <- c(ad.rda.bat_prop.percentile, ad.rda.trt_prop.percentile)"
"0","ad.rda.prop.svd <- c(ad.rda.bat_prop.svd, ad.rda.trt_prop.svd)"
"0","ad.rda.prop.ruv <- c(ad.rda.bat_prop.ruv, ad.rda.trt_prop.ruv)"
"0","## merge results"
"0","ad.rda.prop.val <- c(ad.rda.prop.before, ad.rda.prop.bmc, "
"0","                    ad.rda.prop.combat, ad.rda.prop.limma, "
"0","                    ad.rda.prop.percentile, ad.rda.prop.svd, "
"0","                    ad.rda.prop.ruv)"
"0","## add batch, trt and method info"
"0","ad.rda.prop <- data.frame(prop = ad.rda.prop.val, prop.r = round(ad.rda.prop.val, 2), "
"0","                         Method = rep(c('Before', 'BMC', 'ComBat', 'rBE', "
"0","                                        'PN', 'SVD', 'RUVIII'), each = 2), "
"0","                         Type = rep(c('Batch', 'Treatment'), 7))"
"0","# reorder levels"
"0","ad.rda.prop$Method <- factor(ad.rda.prop$Method, levels = unique(ad.rda.prop$Method))"
"0","ggplot(data = ad.rda.prop, aes(x = Method, y = prop, fill = Type)) + "
"0","  geom_bar(stat = ""identity"", position = 'dodge', colour = 'black') + "
"0","  geom_text(data = ad.rda.prop, aes(Method, prop + 2.5, label = prop.r), "
"0","            position = position_dodge(width = 1), size = 3) + theme_bw() + "
"0","  labs(y = ""Variance explained (%)"") + "
"0","  theme(axis.text.x = element_text(angle = 60, hjust = 1), "
"0","        panel.grid = element_blank(), axis.text = element_text(size = 12), "
"0","        axis.title = element_text(size = 15), legend.title = element_text(size = 15), "
"0","        legend.text = element_text(size = 12)) + scale_fill_hue(l = 40) + ylim(0,100)"
