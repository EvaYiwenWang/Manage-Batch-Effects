"0","############"
"0","# AD data"
"0","silh.ad.before = calc.sil(pca.ad.before$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.bmc = calc.sil(pca.ad.bmc$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.combat = calc.sil(pca.ad.combat$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.limma = calc.sil(pca.ad.limma$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.percentile = calc.sil(pca.ad.percentile$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.svd = calc.sil(pca.ad.svd$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","silh.ad.ruv = calc.sil(pca.ad.ruv$variates$X,y1 = ad.batch, y2= ad.trt, name.y1 = 'Batch',name.y2 = 'Treatment')"
"0","data.plot.ad = rbind(silh.ad.before, silh.ad.bmc, silh.ad.combat, silh.ad.limma, silh.ad.percentile, silh.ad.svd,silh.ad.ruv)"
"0","data.plot.ad$method = c(rep('Before', nrow(silh.ad.before)), "
"0","                            rep('BMC', nrow(silh.ad.bmc)),"
"0","                            rep('ComBat', nrow(silh.ad.combat)),"
"0","                            rep('rBE', nrow(silh.ad.limma)),"
"0","                            rep('PN', nrow(silh.ad.percentile)),"
"0","                            rep('SVD', nrow(silh.ad.svd)),"
"0","                        rep('RUVIII', nrow(silh.ad.ruv))"
"0",")"
"0","data.plot.ad$method = factor(data.plot.ad$method, levels = unique(data.plot.ad$method))"
"0","data.plot.ad$Cluster =  factor(data.plot.ad$Cluster, levels = unique(data.plot.ad$Cluster))"
"0","data.plot.ad$Type =  factor(data.plot.ad$Type, levels = unique(data.plot.ad$Type))"
"0","ggplot(data.plot.ad, aes(x=Type, y=silh.coeff, color = Cluster, shape = Type)) + geom_point() + facet_grid(cols = vars(method)) + theme_bw() + theme(axis.text.x = element_text(angle = 60, hjust = 1), strip.text = element_text(size=12),panel.grid = element_blank(),axis.text = element_text(size=10),axis.title = element_text(size=15),legend.title = element_text(size=15),legend.text = element_text(size=12)) + scale_color_manual(values=c(""#388ECC"", ""#F68B33"", ""#C2C2C2"", ""#009E73"", ""#CC79A7"",""#0072B2"", ""#999999"")) + labs(x = ""Type"", y = ""Silhouette Coefficient"", name=""Type"") "
