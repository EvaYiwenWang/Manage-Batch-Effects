"0","###################"
"0","# Sponge data"
"0","silh.sponge.before = calc.sil(pca.sponge.before$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","silh.sponge.bmc = calc.sil(pca.sponge.bmc$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","silh.sponge.combat = calc.sil(pca.sponge.combat$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","silh.sponge.limma = calc.sil(pca.sponge.limma$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","silh.sponge.percentile = calc.sil(pca.sponge.percentile$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","silh.sponge.svd = calc.sil(pca.sponge.svd$variates$X,y1 = sponge.batch, y2= sponge.trt, name.y1 = 'Batch',name.y2 = 'Tissue')"
"0","data.plot.sponge = rbind(silh.sponge.before, silh.sponge.bmc, silh.sponge.combat, silh.sponge.limma, silh.sponge.percentile, silh.sponge.svd)"
"0","data.plot.sponge$method = c(rep('Before', nrow(silh.sponge.before)), "
"0","                            rep('BMC', nrow(silh.sponge.bmc)),"
"0","                            rep('ComBat', nrow(silh.sponge.combat)),"
"0","                            rep('rBE', nrow(silh.sponge.limma)),"
"0","                            rep('PN', nrow(silh.sponge.percentile)),"
"0","                            rep('SVD', nrow(silh.sponge.svd))"
"0",")"
"0","data.plot.sponge$method = factor(data.plot.sponge$method,levels = unique(data.plot.sponge$method))"
"0","data.plot.sponge$Cluster =  factor(data.plot.sponge$Cluster, levels = unique(data.plot.sponge$Cluster))"
"0","data.plot.sponge$Type =  factor(data.plot.sponge$Type, levels = unique(data.plot.sponge$Type))"
"0","ggplot(data.plot.sponge, aes(x=Type, y=silh.coeff, color = Cluster, shape = Type)) + geom_point() + facet_grid(cols = vars(method)) + theme_bw() + theme(axis.text.x = element_text(angle = 60, hjust = 1), strip.text = element_text(size=12),panel.grid = element_blank(), axis.text = element_text(size=12),axis.title = element_text(size=15),legend.title = element_text(size=15),legend.text = element_text(size=12)) + scale_color_manual(values = c(""#388ECC"",""#F68B33"",""#F0E442"",""#D55E00"")) + labs(x = ""Type"", y = ""Silhouette Coefficient"", name=""Type"") "
